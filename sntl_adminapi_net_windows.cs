/*set PATH=c:\Windows\Microsoft.NET\Framework64\v4.0.30319;%PATH%cls && csc.exe -debug- -target:winexe -platform:x64 -r:sntl_adminapi_net_windows.dll sntl_adminapi_net_windows.cs && sntl_adminapi_net_windows.execsc -target:winexe -platform:x64 /r:sntl_adminapi_net_windows.dll sntl_adminapi_net_windows.cs && sntl_adminapi_net_windows.exe*/using System;using System.Runtime.InteropServices; // ez a névtér szükséges a DLL-ek miattusing System.Xml;using System.IO;using SafeNet.Sentinel;using System.Collections.Generic;using System.Text;public class WinAPI{   // https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-messagebox    [DllImport("user32.dll")]    public static extern int MessageBox(int hWnd, string text, string caption, uint type);}public class CSV{    Dictionary<string, List<string>> data = new Dictionary<string, List<string>>();    public CSV(String fileName)    {        try        {            string[] lines = File.ReadAllLines(fileName, Encoding.UTF8);            foreach (var line in lines)            {                string[] row = line.Split(';');                data.Add(row[1], new List<string>());                data[row[1]].Add(row[0]);                data[row[1]].Add(row[2]);                data[row[1]].Add(row[3]);            }        }        catch        {            throw;        }    }    public string getData(string id)    {        return "\nKulcs szám: " + data[id][0] +                "\nKörzet: " + data[id][1] +                "\nNév: " + data[id][2];    }}namespace TrySentinelLDK{    class TrySentinelLDK    {        private static AdminApi adminApi;        private static int vendorId = ...;        static void Main(string[] args)        {            string scope = "";            string format = "";            string info = "";            adminApi = new AdminApi("localhost", 1947, "");            AdminStatus rc = default(AdminStatus);            try            {                rc = adminApi.connect();                // WinAPI.MessageBox(0, "["+rc.ToString()+"]", "MessageBox...", 0);                scope = "<haspscope>" +                        " <vendor id=\"" + vendorId + "\" />" +                        "</haspscope>";                format = "<admin> <hasp>" +                        //"  <element name=\"*\" />" +                        "  <element name=\"haspid\" />" +                        "</hasp></admin>";                rc = adminApi.adminGet(scope, format, ref info);                //Console.WriteLine(info);                //WinAPI.MessageBox(0, "["+rc.ToString()+"]" + Convert.ToChar(10)+ Convert.ToChar(10) + info, "MessageBox...", 0);                XmlReader reader = XmlReader.Create(new StringReader(info));                while (reader.Read())                {                    //Console.WriteLine(reader.ReadOuterXml());                    if (reader.NodeType == XmlNodeType.Element && reader.Name == "haspid" && reader.Read())                    {                        CSV csv = new CSV("sntl_adminapi_net_windows.csv");                        //WinAPI.MessageBox(0, reader.Value, "Kulcs sorszám...", 0x00000040);                        WinAPI.MessageBox(0, "Gyári szám: " + reader.Value + csv.getData(reader.Value), "Kulcs sorszám...", 0x00000040);                    }                }            }            catch (Exception e)            {                WinAPI.MessageBox(0, e.Message, "Hiba...", 0);            }        }    }}